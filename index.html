<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QUANTUM VAULT | Experimental Post-Quantum Encryption Demo</title>
  <meta name="description" content="Experimental post-quantum encryption demo using X-Wing (ML-KEM-768 + X25519) and ML-DSA-65 digital signatures. Educational client-side cryptography ‚Äî not audited for production use.">
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1">
  <meta name="author" content="ERRERLabs">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="QUANTUM VAULT | Experimental Post-Quantum Encryption Demo">
  <meta property="og:description" content="Experimental post-quantum encryption demo using X-Wing hybrid KEM and ML-DSA-65 digital signatures. Educational ‚Äî not audited for production use.">
  <meta property="og:site_name" content="Quantum Vault">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="QUANTUM VAULT | Experimental Post-Quantum Encryption Demo">
  <meta name="twitter:description" content="Experimental post-quantum encryption demo using X-Wing hybrid KEM and ML-DSA-65. Educational ‚Äî not audited for production use.">

  <!-- Resource Hints -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="https://esm.sh">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Manifest -->
  <link rel="manifest" href="/site.webmanifest">
  <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-card: #12121a;
      --bg-elevated: #1a1a25;
      --accent-cyan: #00f5ff;
      --accent-magenta: #ff00aa;
      --accent-violet: #8b5cf6;
      --accent-green: #00ff88;
      --accent-orange: #ff6b35;
      --accent-red: #ff3366;
      --accent-gold: #ffd700;
      --text-primary: #ffffff;
      --text-secondary: #8888aa;
      --text-dim: #555566;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Space Mono', monospace; background: var(--bg-deep); color: var(--text-primary); min-height: 100vh; }
    .bg-grid { position: fixed; inset: 0; background-image: linear-gradient(rgba(0,245,255,0.02) 1px, transparent 1px), linear-gradient(90deg, rgba(0,245,255,0.02) 1px, transparent 1px); background-size: 40px 40px; pointer-events: none; }
    .app { position: relative; z-index: 10; min-height: 100vh; display: flex; flex-direction: column; }
    
    header { padding: 1.5rem 2rem; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); flex-wrap: wrap; gap: 1rem; }
    .logo { display: flex; align-items: center; gap: 1rem; }
    .logo-icon { width: 44px; height: 44px; background: linear-gradient(135deg, var(--accent-cyan), var(--accent-violet)); display: flex; align-items: center; justify-content: center; font-size: 1.3rem; clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); }
    .logo-text { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.4rem; letter-spacing: 0.1em; }
    .logo-text span { color: var(--accent-cyan); }
    .badges { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .badge { padding: 0.4rem 0.8rem; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.1em; border: 1px solid; }
    .badge.gold { border-color: var(--accent-gold); color: var(--accent-gold); background: rgba(255,215,0,0.1); }
    .badge.green { border-color: var(--accent-green); color: var(--accent-green); }
    .badge.violet { border-color: var(--accent-violet); color: var(--accent-violet); }
    .badge.orange { border-color: var(--accent-orange); color: var(--accent-orange); background: rgba(255,107,53,0.1); }

    .disclaimer-banner { background: rgba(255,107,53,0.12); border: 1px solid var(--accent-orange); padding: 1rem 1.5rem; margin-bottom: 1.5rem; font-size: 0.78rem; color: var(--text-secondary); line-height: 1.6; }
    .disclaimer-banner strong { color: var(--accent-orange); display: block; margin-bottom: 0.3rem; font-size: 0.85rem; }
    .disclaimer-banner ul { margin: 0.5rem 0 0 1.2rem; }
    .disclaimer-banner li { margin-bottom: 0.25rem; }

    .hero-section { margin-bottom: 2rem; padding: 2rem 2.5rem; background: var(--bg-card); border: 1px solid rgba(255,255,255,0.06); border-left: 4px solid var(--accent-cyan); }
    .hero-section h2 { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.6rem; margin-bottom: 1.25rem; line-height: 1.3; }
    .hero-section h2 span { background: linear-gradient(90deg, var(--accent-cyan), var(--accent-violet)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-section p { font-size: 0.88rem; color: var(--text-secondary); line-height: 1.85; margin-bottom: 0.85rem; }
    .hero-section p:last-child { margin-bottom: 0; }
    .hero-section strong { color: var(--text-primary); }
    .hero-section .hero-cta { color: var(--accent-cyan); font-size: 0.92rem; font-weight: 600; }

    .loading { position: fixed; inset: 0; background: var(--bg-deep); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; transition: opacity 0.5s; }
    .loading.hidden { opacity: 0; pointer-events: none; }
    .spinner { width: 50px; height: 50px; border: 3px solid var(--bg-elevated); border-top-color: var(--accent-cyan); border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loading-text { margin-top: 1.5rem; color: var(--text-secondary); font-size: 0.9rem; }
    .loading-sub { margin-top: 0.5rem; color: var(--text-dim); font-size: 0.75rem; }

    main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }
    
    .tabs { display: flex; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 2rem; overflow-x: auto; }
    .tab { padding: 1rem 1.5rem; background: transparent; border: none; font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.85rem; letter-spacing: 0.08em; color: var(--text-dim); cursor: pointer; position: relative; white-space: nowrap; transition: color 0.3s; }
    .tab:hover { color: var(--text-secondary); }
    .tab.active { color: var(--accent-cyan); }
    .tab.active::after { content: ''; position: absolute; bottom: -1px; left: 0; right: 0; height: 2px; background: var(--accent-cyan); }

    .panel { display: none; animation: fadeIn 0.3s; }
    .panel.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } }

    .card { background: var(--bg-card); border: 1px solid rgba(255,255,255,0.06); padding: 1.75rem; }
    .card-head { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.25rem; }
    .card-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1.15rem; }
    .card-sub { font-size: 0.7rem; color: var(--text-dim); margin-top: 0.2rem; }
    .card-badge { padding: 0.2rem 0.6rem; font-size: 0.6rem; text-transform: uppercase; letter-spacing: 0.08em; border: 1px solid var(--accent-gold); color: var(--accent-gold); }

    .info-box { background: var(--bg-elevated); padding: 1rem; margin-bottom: 1.25rem; font-size: 0.78rem; color: var(--text-secondary); line-height: 1.6; border-left: 3px solid var(--accent-violet); }
    .info-box strong { color: var(--accent-cyan); }
    .info-box code { color: var(--accent-green); background: rgba(0,255,136,0.1); padding: 0.1rem 0.25rem; font-size: 0.72rem; }

    .security-features { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1.25rem; }
    .sec-feat { display: flex; align-items: center; gap: 0.5rem; font-size: 0.72rem; color: var(--text-secondary); }
    .sec-feat .icon { color: var(--accent-green); }

    .btn { width: 100%; padding: 0.9rem; font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.85rem; letter-spacing: 0.08em; text-transform: uppercase; background: transparent; border: 2px solid var(--accent-cyan); color: var(--accent-cyan); cursor: pointer; transition: all 0.3s; }
    .btn:hover:not(:disabled) { background: var(--accent-cyan); color: var(--bg-deep); box-shadow: 0 0 25px rgba(0,245,255,0.3); }
    .btn:disabled { opacity: 0.3; cursor: not-allowed; }
    .btn.gold { border-color: var(--accent-gold); color: var(--accent-gold); }
    .btn.gold:hover:not(:disabled) { background: var(--accent-gold); box-shadow: 0 0 25px rgba(255,215,0,0.3); }
    .btn.green { border-color: var(--accent-green); color: var(--accent-green); }
    .btn.green:hover:not(:disabled) { background: var(--accent-green); box-shadow: 0 0 25px rgba(0,255,136,0.3); }
    .btn.magenta { border-color: var(--accent-magenta); color: var(--accent-magenta); }
    .btn.magenta:hover:not(:disabled) { background: var(--accent-magenta); box-shadow: 0 0 25px rgba(255,0,170,0.3); }

    .key-out { margin-top: 1.25rem; display: none; }
    .key-out.visible { display: block; }
    .key-section { margin-bottom: 0.75rem; }
    .key-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.4rem; }
    .key-label { font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.08em; }
    .key-size { font-size: 0.65rem; color: var(--accent-cyan); }
    .key-copy { padding: 0.2rem 0.4rem; background: transparent; border: 1px solid var(--text-dim); color: var(--text-dim); font-size: 0.6rem; cursor: pointer; transition: all 0.3s; }
    .key-copy:hover { border-color: var(--accent-cyan); color: var(--accent-cyan); }
    .key-val { background: var(--bg-elevated); padding: 0.6rem; font-size: 0.65rem; color: var(--accent-green); word-break: break-all; max-height: 70px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.03); }
    .key-val.private { color: var(--accent-orange); }

    .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.75rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.05); }
    @media (max-width: 500px) { .stats { grid-template-columns: repeat(2, 1fr); } }
    .stat { text-align: center; }
    .stat-val { font-size: 0.9rem; font-weight: 700; color: var(--accent-cyan); }
    .stat-label { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; }

    .dropzone { border: 2px dashed rgba(255,255,255,0.15); padding: 2.5rem 1.5rem; text-align: center; cursor: pointer; margin-bottom: 1.25rem; transition: all 0.3s; }
    .dropzone:hover, .dropzone.drag { border-color: var(--accent-cyan); background: rgba(0,245,255,0.03); }
    .drop-icon { font-size: 2.5rem; margin-bottom: 0.75rem; }
    .drop-text { color: var(--text-secondary); margin-bottom: 0.4rem; font-size: 0.85rem; }
    .drop-hint { font-size: 0.7rem; color: var(--text-dim); }

    .file-info { background: var(--bg-elevated); padding: 0.75rem; margin-bottom: 1.25rem; display: none; align-items: center; gap: 0.75rem; }
    .file-info.visible { display: flex; }
    .file-icon { font-size: 1.5rem; }
    .file-details { flex: 1; }
    .file-name { font-size: 0.85rem; margin-bottom: 0.15rem; }
    .file-size { font-size: 0.7rem; color: var(--text-dim); }
    .file-remove { padding: 0.4rem 0.6rem; background: transparent; border: 1px solid var(--accent-red); color: var(--accent-red); cursor: pointer; font-size: 0.75rem; }

    .input-group { margin-bottom: 1.25rem; }
    .input-label { font-size: 0.7rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.4rem; }
    .input { width: 100%; padding: 0.7rem; background: var(--bg-elevated); border: 1px solid rgba(255,255,255,0.08); color: var(--text-primary); font-family: 'Space Mono', monospace; font-size: 0.78rem; }
    .input:focus { outline: none; border-color: var(--accent-cyan); }
    .input::placeholder { color: var(--text-dim); }
    .textarea { min-height: 100px; resize: vertical; }

    .progress { display: none; margin-top: 1.25rem; }
    .progress.visible { display: block; }
    .progress-head { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--text-secondary); margin-bottom: 0.4rem; }
    .progress-bar { height: 4px; background: var(--bg-elevated); }
    .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-cyan), var(--accent-violet)); transition: width 0.3s; }

    .result { display: none; margin-top: 1.25rem; padding: 1.25rem; background: rgba(0,255,136,0.08); border: 1px solid var(--accent-green); }
    .result.visible { display: block; }
    .result.error { background: rgba(255,51,102,0.08); border-color: var(--accent-red); }
    .result-head { display: flex; align-items: center; gap: 0.6rem; margin-bottom: 0.75rem; }
    .result-icon { font-size: 1.25rem; }
    .result-title { font-family: 'Syne', sans-serif; font-weight: 600; color: var(--accent-green); font-size: 0.95rem; }
    .result.error .result-title { color: var(--accent-red); }
    .result-btn { padding: 0.5rem 1rem; background: var(--accent-green); border: none; color: var(--bg-deep); font-family: 'Space Mono', monospace; font-size: 0.75rem; cursor: pointer; font-weight: 600; }
    .result-btn:hover { opacity: 0.85; }

    .sig-out { background: var(--bg-elevated); padding: 1rem; margin-top: 1.25rem; display: none; }
    .sig-out.visible { display: block; }
    .sig-label { font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; margin-bottom: 0.4rem; }
    .sig-val { font-size: 0.65rem; color: var(--accent-magenta); word-break: break-all; max-height: 90px; overflow-y: auto; }

    .toast { position: fixed; bottom: 1.5rem; right: 1.5rem; padding: 0.9rem 1.25rem; background: var(--bg-card); border: 1px solid var(--accent-cyan); font-size: 0.8rem; transform: translateY(100px); opacity: 0; transition: all 0.3s; z-index: 100; max-width: 350px; }
    .toast.visible { transform: translateY(0); opacity: 1; }
    .toast.error { border-color: var(--accent-red); }

    .warning-box { background: rgba(255,107,53,0.1); border: 1px solid var(--accent-orange); padding: 1rem; margin-bottom: 1.25rem; font-size: 0.75rem; color: var(--accent-orange); }
    .warning-box strong { display: block; margin-bottom: 0.3rem; }

    /* Education Section Styles */
    .education-section { margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.08); }
    .edu-header { text-align: center; margin-bottom: 2.5rem; }
    .edu-header h2 { font-family: 'Syne', sans-serif; font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; }
    .edu-header h2 span { color: var(--accent-cyan); }
    .edu-header p { color: var(--text-secondary); font-size: 0.85rem; max-width: 600px; margin: 0 auto; }

    .edu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem; }

    .edu-card { background: var(--bg-card); border: 1px solid rgba(255,255,255,0.06); padding: 1.5rem; transition: border-color 0.3s; }
    .edu-card:hover { border-color: rgba(255,255,255,0.15); }
    
    .edu-card-header { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem; }
    .edu-card-icon { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; background: var(--bg-elevated); border-radius: 8px; }
    .edu-card-title { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 1rem; }
    .edu-card-subtitle { font-size: 0.7rem; color: var(--text-dim); margin-top: 0.15rem; }

    .edu-card-body { font-size: 0.8rem; color: var(--text-secondary); line-height: 1.7; }
    .edu-card-body p { margin-bottom: 0.75rem; }
    .edu-card-body p:last-child { margin-bottom: 0; }

    .edu-meta { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.05); }
    .edu-tag { padding: 0.25rem 0.5rem; font-size: 0.6rem; text-transform: uppercase; letter-spacing: 0.05em; background: var(--bg-elevated); color: var(--text-dim); }
    .edu-tag.pro { background: rgba(0,255,136,0.1); color: var(--accent-green); }
    .edu-tag.con { background: rgba(255,51,102,0.1); color: var(--accent-red); }
    .edu-tag.year { background: rgba(139,92,246,0.1); color: var(--accent-violet); }

    .edu-highlight { background: rgba(0,245,255,0.08); border-left: 3px solid var(--accent-cyan); padding: 0.75rem 1rem; margin: 0.75rem 0; font-size: 0.78rem; }
    .edu-highlight strong { color: var(--accent-cyan); }

    .edu-comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem; }
    @media (max-width: 500px) { .edu-comparison { grid-template-columns: 1fr; } }
    .edu-comp-col h4 { font-size: 0.75rem; color: var(--accent-green); margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.05em; }
    .edu-comp-col.weak h4 { color: var(--accent-red); }
    .edu-comp-col ul { list-style: none; font-size: 0.75rem; color: var(--text-secondary); }
    .edu-comp-col ul li { padding: 0.25rem 0; padding-left: 1rem; position: relative; }
    .edu-comp-col ul li::before { content: '‚úì'; position: absolute; left: 0; color: var(--accent-green); }
    .edu-comp-col.weak ul li::before { content: '‚úó'; color: var(--accent-red); }

    .timeline { position: relative; padding-left: 1.5rem; margin-top: 1rem; }
    .timeline::before { content: ''; position: absolute; left: 0.4rem; top: 0.5rem; bottom: 0.5rem; width: 2px; background: var(--bg-elevated); }
    .timeline-item { position: relative; padding-bottom: 0.75rem; }
    .timeline-item:last-child { padding-bottom: 0; }
    .timeline-item::before { content: ''; position: absolute; left: -1.1rem; top: 0.35rem; width: 8px; height: 8px; background: var(--accent-violet); border-radius: 50%; }
    .timeline-year { font-size: 0.7rem; color: var(--accent-violet); font-weight: 700; }
    .timeline-text { font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.15rem; }
  </style>
</head>
<body>
  <div class="bg-grid"></div>
  <div class="loading" id="loading">
    <div class="spinner"></div>
    <div class="loading-text">Initializing Cryptography Demo...</div>
    <div class="loading-sub">Loading X-Wing (ML-KEM-768 + X25519) &amp; ML-DSA</div>
  </div>

  <div class="app">
    <header>
      <div class="logo">
        <div class="logo-icon">üõ°Ô∏è</div>
        <div class="logo-text">QUANTUM<span>VAULT</span></div>
      </div>
      <div class="badges">
        <div class="badge orange">Experimental Demo</div>
        <div class="badge green">X-Wing Hybrid KEM</div>
        <div class="badge violet">IETF Draft (Not Final)</div>
      </div>
    </header>

    <main>
      <div class="disclaimer-banner">
        <strong>Experimental Demo ‚Äî Not Audited for Production Use</strong>
        This tool demonstrates real post-quantum cryptographic algorithms (X-Wing, ML-DSA-65) running client-side using the <code>@noble/post-quantum</code> library (v0.5.2, pre-1.0). The cryptography is functional, but be aware of the following limitations before relying on it for sensitive data:
        <ul>
          <li><strong>No independent security audit</strong> has been performed on this application.</li>
          <li><strong>X-Wing is an IETF draft</strong>, not a finalized standard. The specification may change.</li>
          <li><strong>Key handling is not production-safe:</strong> secret keys are displayed in the DOM (visible to browser extensions and screen sharing), copied to the system clipboard (accessible to other apps), and cannot be securely erased from JavaScript memory.</li>
          <li><strong>Crypto library loaded from CDN</strong> (esm.sh) without Subresource Integrity (SRI) hashes ‚Äî a compromised CDN could serve malicious code.</li>
          <li><strong>Encrypted file metadata is not encrypted:</strong> the .pqenc format stores the original filename, file size, and timestamp in plaintext.</li>
          <li><strong>No key management:</strong> you must securely store your own keys outside this tool. There is no built-in key storage or backup.</li>
        </ul>
      </div>

      <div class="hero-section">
        <h2>Your encryption has an <span>expiration date</span>.</h2>
        <p>Nearly all internet security ‚Äî the padlock in your browser, your messaging apps, your bank's login page ‚Äî depends on math that quantum computers will break. Algorithms like RSA and elliptic curve cryptography protect trillions of dollars and billions of private conversations right now. <strong>Shor's algorithm</strong>, running on powerful enough quantum hardware, will crack them open.</p>
        <p>This isn't a far-off scenario. Intelligence agencies are already stockpiling encrypted traffic today, waiting for quantum hardware to catch up. Cryptographers call this <strong>"harvest now, decrypt later"</strong> ‚Äî and it means data you encrypt today may not stay private forever.</p>
        <p>The countermeasure is already here. After an 8-year worldwide competition, NIST finalized the first <strong>post-quantum cryptographic standards</strong> in 2024 ‚Äî algorithms built on lattice math so hard that no known quantum attack can efficiently solve it.</p>
        <p class="hero-cta">This tool puts those algorithms in your hands. Generate real post-quantum keys. Encrypt real files. Sign real messages. Everything runs in your browser ‚Äî nothing simulated, nothing sent to any server.</p>
      </div>

      <nav class="tabs">
        <button class="tab active" data-tab="keygen">Generate Keys</button>
        <button class="tab" data-tab="encrypt">Encrypt / Decrypt</button>
        <button class="tab" data-tab="sign">Sign / Verify</button>
      </nav>

      <!-- KEY GENERATION -->
      <div class="panel active" id="panel-keygen">
        <div class="warning-box">
          <strong>Key Security Warning</strong>
          Generated keys are displayed in the page DOM and are accessible to browser extensions, screen capture, and developer tools. Copying keys sends them to your system clipboard, which may be readable by other applications. JavaScript cannot securely erase keys from memory. Store exported keys in a secure location outside your browser.
        </div>
        <div class="grid">
          <div class="card">
            <div class="card-head">
              <div>
                <div class="card-title">X-Wing Hybrid KEM</div>
                <div class="card-sub">ML-KEM-768 + X25519 | IETF Draft</div>
              </div>
              <div class="card-badge">Hybrid</div>
            </div>
            
            <div class="info-box">
              <strong>X-Wing</strong> combines <code>ML-KEM-768</code> (post-quantum) with <code>X25519</code> (classical)
              using SHA3-256 as the combiner. Secure if <em>either</em> algorithm remains secure.
              <br><br><strong>Note:</strong> X-Wing is an <em>IETF draft</em>, not a finalized standard. The specification may change before ratification.
            </div>

            <div class="security-features">
              <div class="sec-feat"><span class="icon">‚úì</span> IND-CCA2 secure</div>
              <div class="sec-feat"><span class="icon">‚úì</span> Formally proven</div>
              <div class="sec-feat"><span class="icon">‚úì</span> 128-bit classical</div>
              <div class="sec-feat"><span class="icon">‚úì</span> Post-quantum safe</div>
            </div>

            <button class="btn gold" id="xwing-btn" onclick="genXWing()">Generate X-Wing Keypair</button>

            <div class="key-out" id="xwing-keys">
              <div class="key-section">
                <div class="key-head">
                  <span class="key-label">Public Key <span class="key-size" id="xwing-pk-sz"></span></span>
                  <button class="key-copy" onclick="copyEl('xwing-pk')">Copy</button>
                </div>
                <div class="key-val" id="xwing-pk"></div>
              </div>
              <div class="key-section">
                <div class="key-head">
                  <span class="key-label">Secret Key <span class="key-size" id="xwing-sk-sz"></span></span>
                  <button class="key-copy" onclick="copyEl('xwing-sk')">Copy</button>
                </div>
                <div class="key-val private" id="xwing-sk"></div>
              </div>
              <div class="stats" id="xwing-stats"></div>
            </div>
          </div>

          <div class="card">
            <div class="card-head">
              <div>
                <div class="card-title">ML-DSA-65 Signatures</div>
                <div class="card-sub">NIST FIPS 204 | 192-bit security</div>
              </div>
              <div class="card-badge">Signatures</div>
            </div>
            
            <div class="info-box">
              <strong>ML-DSA-65</strong> (Dilithium) provides unforgeable digital signatures.
              NIST Category 3 security (~AES-192). Lattice-based, standardized in FIPS 204.
            </div>

            <div class="security-features">
              <div class="sec-feat"><span class="icon">‚úì</span> EUF-CMA secure</div>
              <div class="sec-feat"><span class="icon">‚úì</span> NIST standardized</div>
              <div class="sec-feat"><span class="icon">‚úì</span> 192-bit security</div>
              <div class="sec-feat"><span class="icon">‚úì</span> Quantum resistant</div>
            </div>

            <button class="btn magenta" id="dsa-btn" onclick="genDSA()">Generate ML-DSA-65 Keypair</button>

            <div class="key-out" id="dsa-keys">
              <div class="key-section">
                <div class="key-head">
                  <span class="key-label">Public Key <span class="key-size" id="dsa-pk-sz"></span></span>
                  <button class="key-copy" onclick="copyEl('dsa-pk')">Copy</button>
                </div>
                <div class="key-val" id="dsa-pk"></div>
              </div>
              <div class="key-section">
                <div class="key-head">
                  <span class="key-label">Secret Key <span class="key-size" id="dsa-sk-sz"></span></span>
                  <button class="key-copy" onclick="copyEl('dsa-sk')">Copy</button>
                </div>
                <div class="key-val private" id="dsa-sk"></div>
              </div>
              <div class="stats" id="dsa-stats"></div>
            </div>
          </div>
        </div>

        <!-- EDUCATION SECTION FOR KEYGEN -->
        <div class="education-section">
          <div class="edu-header">
            <h2>üìö Understanding <span>Cryptographic Keys</span></h2>
            <p>The ideas behind the algorithms you just used, from first principles to implementation details ‚Äî whether this is your first encounter with cryptography or your hundredth.</p>
          </div>

          <div class="edu-grid">
            <!-- What is a Key? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üîë</div>
                <div>
                  <div class="edu-card-title">What is a Cryptographic Key?</div>
                  <div class="edu-card-subtitle">You use them every day without knowing it</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>Every time your browser shows a padlock, a cryptographic key is protecting that connection. Every Signal message, every banking session, every software update ‚Äî keys are doing the work invisibly.</p>
                <p>A cryptographic key is a piece of randomly generated data ‚Äî think of it as a very long, very random password ‚Äî that controls how encryption and decryption behave. Unlike a password you choose (which might be guessable), a good cryptographic key comes from a cryptographically secure random number generator. The keys on this page use your browser's <code>crypto.getRandomValues()</code> ‚Äî the same CSPRNG used by banking and government systems.</p>
                <div class="edu-highlight">
                  <strong>Public key</strong> = an open mailbox slot. Anyone can drop a letter in.<br>
                  <strong>Private key</strong> = the only key that opens that mailbox.<br>
                  Lose your private key and your data is gone forever. Leak it and your security is gone instantly.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">1976</span>
                <span class="edu-tag">Diffie &amp; Hellman</span>
                <span class="edu-tag">Asymmetric crypto</span>
              </div>
            </div>

            <!-- What is Post-Quantum? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">‚öõÔ∏è</div>
                <div>
                  <div class="edu-card-title">What is Post-Quantum Cryptography?</div>
                  <div class="edu-card-subtitle">The biggest upgrade in cryptography since public keys</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>In 1994, mathematician Peter Shor proved that a quantum computer could factor large numbers and compute discrete logarithms in polynomial time. That single theorem threatens nearly all public-key cryptography deployed today ‚Äî RSA, Diffie-Hellman, ECDSA, EdDSA, X25519 ‚Äî all of it falls to Shor's algorithm.</p>
                <p>Post-quantum cryptography replaces the vulnerable math (factoring, discrete logs, elliptic curves) with fundamentally different hard problems: <strong>lattice problems</strong> (used here), hash-based constructions, error-correcting codes, and multivariate equations. These problems resist both classical and quantum attacks based on current mathematical understanding.</p>
                <div class="edu-highlight">
                  <strong>The urgency is real.</strong> The US government has mandated a transition to post-quantum cryptography by 2035. Nation-states are already collecting encrypted traffic to decrypt later. If your data needs to stay secret for 10+ years, the time to switch is now.
                </div>
                <p>NIST ran an 8-year global competition (2016‚Äì2024) and selected <strong>ML-KEM</strong> (encryption) and <strong>ML-DSA</strong> (signatures) as the primary standards. Both are lattice-based and both are used in this tool.</p>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">2016‚Äì2024</span>
                <span class="edu-tag">NIST competition</span>
                <span class="edu-tag">69 submissions ‚Üí 4 winners</span>
              </div>
            </div>

            <!-- What is X-Wing? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">ü¶Ö</div>
                <div>
                  <div class="edu-card-title">What is X-Wing?</div>
                  <div class="edu-card-subtitle">The belt-and-suspenders approach to the quantum transition</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>Here's the honest tension: post-quantum algorithms are built on <em>relatively new</em> mathematics compared to RSA (1977) or elliptic curves (1985). What if there's a flaw nobody has found yet? That pragmatic worry led to a clever engineering answer: <strong>don't bet everything on one algorithm.</strong></p>
                <p>X-Wing is a hybrid KEM that combines <strong>ML-KEM-768</strong> (post-quantum, lattice-based) with <strong>X25519</strong> (classical, elliptic curve) using SHA3-256 as the combiner. The security guarantee: <em>your data stays protected as long as at least one of the two algorithms holds.</em></p>
                <p>Quantum computer breaks X25519? ML-KEM still protects you. Flaw found in lattice math? X25519 still protects you. Both would have to fail simultaneously ‚Äî an event cryptographers consider astronomically unlikely.</p>
                <div class="timeline">
                  <div class="timeline-item"><span class="timeline-year">2024</span><div class="timeline-text">X-Wing specification and formal security proof published</div></div>
                  <div class="timeline-item"><span class="timeline-year">2025</span><div class="timeline-text">IETF draft standardization (still in progress ‚Äî not finalized)</div></div>
                  <div class="timeline-item"><span class="timeline-year">Now</span><div class="timeline-text">Adopted by Chrome, Cloudflare, Signal, and iMessage (hybrid PQ)</div></div>
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag pro">Hybrid security</span>
                <span class="edu-tag pro">Formally proven</span>
                <span class="edu-tag">IETF draft (not final)</span>
              </div>
            </div>

            <!-- What is ML-KEM? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üî∑</div>
                <div>
                  <div class="edu-card-title">What is ML-KEM (Kyber)?</div>
                  <div class="edu-card-subtitle">The math that quantum computers can't crack</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>Imagine a grid of points stretching across hundreds of dimensions. Someone gives you a point that's <em>slightly</em> off the grid and asks: what's the nearest grid point? In two or three dimensions, this is trivial. In hundreds of dimensions, it becomes so hard that no known algorithm ‚Äî classical or quantum ‚Äî can solve it efficiently.</p>
                <p>This is the <strong>Learning With Errors (LWE)</strong> problem, and it's the mathematical foundation of ML-KEM. The "module" variant works over structured lattices for better performance, giving us a practical algorithm that survived 8 years of the world's best cryptanalysts trying to break it.</p>
                <p><strong>ML-KEM-768</strong> (the variant used in X-Wing) was submitted to NIST as "Kyber," was standardized as FIPS 203 in 2024, and operates at Category 1 security (128-bit equivalent). Key sizes are larger than classical crypto ‚Äî 1,216 bytes for a public key vs. 32 bytes for X25519 ‚Äî but generation and encapsulation are fast, often faster than RSA.</p>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">2024</span>
                <span class="edu-tag">FIPS 203</span>
                <span class="edu-tag">IND-CCA2</span>
                <span class="edu-tag">Lattice-based</span>
              </div>
            </div>

            <!-- What is ML-DSA? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">‚úçÔ∏è</div>
                <div>
                  <div class="edu-card-title">What is ML-DSA (Dilithium)?</div>
                  <div class="edu-card-subtitle">Unforgeable proof in a post-quantum world</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>Every time your phone verifies a software update, every time your browser checks a website's certificate, every time a Bitcoin transaction is confirmed ‚Äî a <strong>digital signature</strong> is doing the work. Signatures are the invisible trust infrastructure of the internet.</p>
                <p>ML-DSA (formerly Dilithium) is the post-quantum replacement for signature algorithms like ECDSA and EdDSA that Shor's algorithm will break. It provides three mathematical guarantees that handwritten signatures never could:</p>
                <p><strong>1. Authentication</strong> ‚Äî proves who created the signature<br>
                   <strong>2. Integrity</strong> ‚Äî proves the message wasn't altered after signing<br>
                   <strong>3. Non-repudiation</strong> ‚Äî the signer cannot plausibly deny they signed it</p>
                <div class="edu-highlight">
                  <strong>ML-DSA-65</strong> operates at NIST Category 3 (~AES-192 equivalent). It's <strong>EUF-CMA</strong> secure ‚Äî meaning signatures can't be forged even by an attacker who can request signatures on arbitrary messages of their choosing.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">2024</span>
                <span class="edu-tag">FIPS 204</span>
                <span class="edu-tag pro">EUF-CMA</span>
                <span class="edu-tag">Category 3</span>
              </div>
            </div>

            <!-- What is X25519? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üìà</div>
                <div>
                  <div class="edu-card-title">What is X25519?</div>
                  <div class="edu-card-subtitle">The most trusted algorithm facing retirement</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p><strong>X25519</strong> is arguably the most successful key agreement protocol ever designed. Created by Daniel J. Bernstein in 2005, it protects TLS (HTTPS), Signal, WhatsApp, SSH, WireGuard, Tor, and dozens of other critical systems. It's fast, elegant, and has an extraordinary security track record over two decades.</p>
                <p>But X25519 is elliptic curve cryptography, and <em>all</em> elliptic curve cryptography falls to Shor's algorithm. A sufficiently powerful quantum computer could recover the private key from a public key in polynomial time. Twenty years of trust won't matter once that machine exists.</p>
                <div class="edu-highlight">
                  <strong>This is exactly why X-Wing pairs it with ML-KEM.</strong> X25519 contributes 20 years of battle-tested confidence. ML-KEM contributes quantum resistance. Together, they cover each other's blind spots ‚Äî classical trust meets post-quantum math.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">2005</span>
                <span class="edu-tag">Curve25519</span>
                <span class="edu-tag pro">20+ years battle-tested</span>
                <span class="edu-tag con">Quantum vulnerable</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ENCRYPT/DECRYPT -->
      <div class="panel" id="panel-encrypt">
        <div class="warning-box">
          <strong>Metadata Privacy Notice</strong>
          The .pqenc encrypted file format stores the original filename, file size, and encryption timestamp in <em>plaintext</em> alongside the encrypted data. Only the file contents are encrypted. An observer who obtains the .pqenc file can see this metadata without the decryption key.
        </div>
        <div class="grid">
          <div class="card">
            <div class="card-head">
              <div>
                <div class="card-title">Encrypt File</div>
                <div class="card-sub">X-Wing KEM + AES-256-GCM</div>
              </div>
            </div>

            <div class="info-box">
              Hybrid encryption: X-Wing encapsulates a shared secret, then HKDF derives an AES-256-GCM key.
              Authenticated encryption with associated data (AEAD).
            </div>

            <div class="dropzone" id="enc-drop" onclick="document.getElementById('enc-file').click()">
              <div class="drop-icon">üìÅ</div>
              <div class="drop-text">Drop file or click to select</div>
              <div class="drop-hint">Any file type supported</div>
            </div>
            <input type="file" id="enc-file" style="display:none">

            <div class="file-info" id="enc-finfo">
              <div class="file-icon">üìÑ</div>
              <div class="file-details">
                <div class="file-name" id="enc-fname"></div>
                <div class="file-size" id="enc-fsize"></div>
              </div>
              <button class="file-remove" onclick="clearEncFile()">‚úï</button>
            </div>

            <div class="input-group">
              <div class="input-label">Recipient's X-Wing Public Key (hex)</div>
              <input class="input" id="enc-pk" placeholder="Paste 1216-byte X-Wing public key...">
            </div>

            <button class="btn green" id="enc-btn" onclick="encryptFile()" disabled>üîí Encrypt File</button>

            <div class="progress" id="enc-prog">
              <div class="progress-head"><span>Encrypting...</span><span id="enc-pct">0%</span></div>
              <div class="progress-bar"><div class="progress-fill" id="enc-fill"></div></div>
            </div>

            <div class="result" id="enc-result">
              <div class="result-head">
                <div class="result-icon">‚úì</div>
                <div class="result-title">Encrypted Successfully</div>
              </div>
              <button class="result-btn" onclick="downloadEnc()">Download .pqenc</button>
            </div>
          </div>

          <div class="card">
            <div class="card-head">
              <div>
                <div class="card-title">Decrypt File</div>
                <div class="card-sub">Requires your X-Wing secret key</div>
              </div>
            </div>

            <div class="dropzone" id="dec-drop" onclick="document.getElementById('dec-file').click()">
              <div class="drop-icon">üîê</div>
              <div class="drop-text">Drop .pqenc file</div>
              <div class="drop-hint">QuantumVault encrypted file</div>
            </div>
            <input type="file" id="dec-file" accept=".pqenc" style="display:none">

            <div class="file-info" id="dec-finfo">
              <div class="file-icon">üîê</div>
              <div class="file-details">
                <div class="file-name" id="dec-fname"></div>
                <div class="file-size" id="dec-fsize"></div>
              </div>
              <button class="file-remove" onclick="clearDecFile()">‚úï</button>
            </div>

            <div class="input-group">
              <div class="input-label">Your X-Wing Secret Key (hex)</div>
              <input class="input" id="dec-sk" placeholder="Paste 32-byte X-Wing secret key...">
            </div>

            <button class="btn" id="dec-btn" onclick="decryptFile()" disabled>üîì Decrypt File</button>

            <div class="progress" id="dec-prog">
              <div class="progress-head"><span>Decrypting...</span><span id="dec-pct">0%</span></div>
              <div class="progress-bar"><div class="progress-fill" id="dec-fill"></div></div>
            </div>

            <div class="result" id="dec-result">
              <div class="result-head">
                <div class="result-icon" id="dec-icon">‚úì</div>
                <div class="result-title" id="dec-title">Decrypted Successfully</div>
              </div>
              <button class="result-btn" onclick="downloadDec()">Download Original</button>
            </div>
          </div>
        </div>

        <!-- EDUCATION SECTION FOR ENCRYPTION -->
        <div class="education-section">
          <div class="edu-header">
            <h2>üìö Understanding <span>Encryption</span></h2>
            <p>What happens when you click "Encrypt" ‚Äî each layer of protection, why it exists, and how the pieces fit together.</p>
          </div>

          <div class="edu-grid">
            <!-- What is Encryption? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üîí</div>
                <div>
                  <div class="edu-card-title">What is Encryption?</div>
                  <div class="edu-card-subtitle">4,000 years old and more important than ever</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>When you send a message through the internet, it passes through routers, servers, and cables owned by dozens of different organizations. Any of them could read it ‚Äî unless it's encrypted.</p>
                <p>Encryption transforms readable data (plaintext) into scrambled data (ciphertext) using a mathematical algorithm and a key. Without the key, the ciphertext is computationally indistinguishable from random noise. With the key, the original data comes back perfectly.</p>
                <div class="edu-highlight">
                  <strong>The ancient version:</strong> Julius Caesar shifted each letter by 3 positions (A‚ÜíD, B‚ÜíE). The modern version uses mathematical transformations so complex that all the computers on Earth, running until the heat death of the universe, couldn't guess the key by brute force.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">~2000 BCE</span>
                <span class="edu-tag">Ancient origins</span>
                <span class="edu-tag">Fundamental primitive</span>
              </div>
            </div>

            <!-- What is a KEM? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üì¶</div>
                <div>
                  <div class="edu-card-title">What is a KEM?</div>
                  <div class="edu-card-subtitle">How two strangers agree on a secret</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>Here's a problem that sounds impossible: you want to send someone an encrypted file, but you've never met them and can't exchange a password in advance. How do you agree on a shared secret key over an insecure channel?</p>
                <p>A <strong>Key Encapsulation Mechanism (KEM)</strong> solves this. Using the recipient's <em>public</em> key ‚Äî which they share openly ‚Äî you generate a random shared secret that only their <em>private</em> key can recover:</p>
                <div class="timeline">
                  <div class="timeline-item"><span class="timeline-year">1</span><div class="timeline-text">You <strong>encapsulate</strong>: feed the recipient's public key into the KEM. Out comes a shared secret (32 bytes) and a ciphertext (1,120 bytes).</div></div>
                  <div class="timeline-item"><span class="timeline-year">2</span><div class="timeline-text">You send the ciphertext to the recipient (it's safe ‚Äî nobody else can extract the secret from it).</div></div>
                  <div class="timeline-item"><span class="timeline-year">3</span><div class="timeline-text">The recipient <strong>decapsulates</strong>: feeds the ciphertext and their private key into the KEM. Out comes the same shared secret.</div></div>
                </div>
                <p>Now both of you have a shared secret key. You never exchanged it directly ‚Äî the math made it happen.</p>
              </div>
              <div class="edu-meta">
                <span class="edu-tag">Modern approach</span>
                <span class="edu-tag pro">No pre-shared secrets needed</span>
              </div>
            </div>

            <!-- What is HKDF? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üß™</div>
                <div>
                  <div class="edu-card-title">What is HKDF?</div>
                  <div class="edu-card-subtitle">Turning a good secret into a perfect key</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>The shared secret from the KEM is good, but it might have subtle statistical patterns or not be exactly the right format for your encryption algorithm. You don't use it directly ‚Äî that would be cryptographically sloppy.</p>
                <p><strong>HKDF</strong> (HMAC-based Key Derivation Function, RFC 5869) takes the shared secret and transforms it into a key that's uniformly random, the right length, and domain-separated ‚Äî meaning even if the same secret were used in a different application, it would produce a completely different key.</p>
                <div class="edu-highlight">
                  <strong>This tool uses:</strong> HKDF-SHA256 with a fresh 32-byte random salt per encryption and the domain separator <code>QuantumVault-v1-AES256GCM</code>. The salt ensures that encrypting the same file twice produces completely different ciphertexts. The domain separator ensures this key is only valid for this specific protocol.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">2010</span>
                <span class="edu-tag">RFC 5869</span>
                <span class="edu-tag pro">Extract-then-expand</span>
              </div>
            </div>

            <!-- What is AES-GCM? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üõ°Ô∏è</div>
                <div>
                  <div class="edu-card-title">What is AES-256-GCM?</div>
                  <div class="edu-card-subtitle">The workhorse that encrypts your actual data</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p><strong>AES</strong> (Advanced Encryption Standard) is the symmetric cipher that does the heavy lifting ‚Äî it's what actually scrambles your file data. Selected by NIST in 2001, it encrypts everything from classified government documents to your iMessage conversations. "256" means 256-bit keys, which gives 2<sup>256</sup> possible keys ‚Äî a number larger than the atoms in the observable universe.</p>
                <p><strong>GCM</strong> (Galois/Counter Mode) is the critical addition that makes this <em>authenticated</em> encryption. It doesn't just hide your data ‚Äî it detects tampering. If an attacker flips even a single bit of the ciphertext, decryption fails entirely rather than producing corrupted output. This property (called <strong>AEAD</strong>) prevents a whole class of attacks where adversaries manipulate ciphertext.</p>
                <div class="edu-highlight">
                  <strong>Quantum-safe.</strong> Grover's algorithm (the best known quantum attack against symmetric ciphers) only halves the effective security: AES-256 drops to 128-bit, which is still computationally infeasible to break. This is why we use 256, not 128.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">2001</span>
                <span class="edu-tag">FIPS 197</span>
                <span class="edu-tag pro">Quantum-safe</span>
                <span class="edu-tag">AEAD</span>
              </div>
            </div>

            <!-- Hybrid Encryption Flow -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üîÑ</div>
                <div>
                  <div class="edu-card-title">How It All Fits Together</div>
                  <div class="edu-card-subtitle">The exact sequence when you click "Encrypt"</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>Every component above plays a specific role. Here's what actually happens in <code>main.js</code> when you encrypt a file:</p>
                <div class="timeline">
                  <div class="timeline-item"><span class="timeline-year">Step 1</span><div class="timeline-text"><strong>KEM:</strong> X-Wing encapsulates a 32-byte shared secret using the recipient's public key. This produces a KEM ciphertext (1,120 bytes) that only the recipient can decapsulate.</div></div>
                  <div class="timeline-item"><span class="timeline-year">Step 2</span><div class="timeline-text"><strong>KDF:</strong> HKDF-SHA256 derives a 256-bit AES key from the shared secret, using a fresh random salt and the domain separator.</div></div>
                  <div class="timeline-item"><span class="timeline-year">Step 3</span><div class="timeline-text"><strong>AEAD:</strong> AES-256-GCM encrypts the file data with a random 12-byte nonce. The ciphertext includes an authentication tag that detects any tampering.</div></div>
                  <div class="timeline-item"><span class="timeline-year">Step 4</span><div class="timeline-text"><strong>Integrity:</strong> SHA-256 hashes the original file, so the recipient can verify the decrypted output matches exactly.</div></div>
                  <div class="timeline-item"><span class="timeline-year">Step 5</span><div class="timeline-text"><strong>Package:</strong> Everything ‚Äî KEM ciphertext, salt, nonce, encrypted data, and metadata ‚Äî is bundled into a .pqenc JSON file.</div></div>
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag pro">Layered defense</span>
                <span class="edu-tag">5 cryptographic operations</span>
              </div>
            </div>

            <!-- Why Not Just Public Key Encrypt Everything? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">‚ùì</div>
                <div>
                  <div class="edu-card-title">Why So Many Layers?</div>
                  <div class="edu-card-subtitle">Each one solves a different problem</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>If you're wondering why we can't just encrypt the file directly with the public key and be done with it ‚Äî good question. The answer is both practical and mathematical.</p>
                <p><strong>Speed:</strong> Public-key operations (KEM, signatures) are orders of magnitude slower than symmetric encryption (AES). Encrypting a 100MB file directly with a KEM would be impractical. AES-GCM, backed by hardware acceleration in modern CPUs, can encrypt gigabytes per second.</p>
                <p><strong>Security margin:</strong> Each layer provides a different guarantee. The KEM ensures only the recipient can recover the key. HKDF ensures the AES key is properly random and domain-separated. AES-GCM ensures both secrecy and tamper detection. SHA-256 provides a final integrity check independent of AES-GCM.</p>
                <div class="edu-highlight">
                  <strong>This layered pattern</strong> ‚Äî KEM ‚Üí KDF ‚Üí AEAD ‚Äî is exactly how TLS 1.3, Signal, WireGuard, and most modern encrypted protocols work. It's not over-engineering. It's the standard architecture for a reason.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag">Defense in depth</span>
                <span class="edu-tag pro">Same pattern as TLS 1.3</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- SIGN/VERIFY -->
      <div class="panel" id="panel-sign">
        <div style="max-width:800px">
          <div class="card" style="margin-bottom:2rem">
            <div class="card-head">
              <div>
                <div class="card-title">Sign Message</div>
                <div class="card-sub">ML-DSA-65 Digital Signature</div>
              </div>
            </div>

            <textarea class="input textarea" id="sign-msg" placeholder="Enter message to sign..."></textarea>

            <div class="input-group">
              <div class="input-label">Your ML-DSA-65 Secret Key (hex)</div>
              <input class="input" id="sign-sk" placeholder="Paste 4032-byte secret key...">
            </div>

            <button class="btn magenta" onclick="signMessage()">‚úçÔ∏è Sign Message</button>

            <div class="sig-out" id="sig-out">
              <div class="sig-label">Signature <span id="sig-sz"></span></div>
              <div class="sig-val" id="sig-val"></div>
              <button class="result-btn" style="margin-top:0.75rem;background:var(--accent-magenta)" onclick="copyEl('sig-val')">Copy Signature</button>
            </div>
          </div>

          <div class="card">
            <div class="card-head">
              <div>
                <div class="card-title">Verify Signature</div>
                <div class="card-sub">Confirm message authenticity</div>
              </div>
            </div>

            <textarea class="input textarea" id="ver-msg" placeholder="Enter original message..."></textarea>

            <div class="input-group">
              <div class="input-label">Signature (hex)</div>
              <input class="input" id="ver-sig" placeholder="Paste signature...">
            </div>

            <div class="input-group">
              <div class="input-label">Signer's ML-DSA-65 Public Key (hex)</div>
              <input class="input" id="ver-pk" placeholder="Paste 1952-byte public key...">
            </div>

            <button class="btn" onclick="verifyMessage()">‚úì Verify Signature</button>

            <div class="result" id="ver-result">
              <div class="result-head">
                <div class="result-icon" id="ver-icon">‚úì</div>
                <div class="result-title" id="ver-title">Signature Valid</div>
              </div>
            </div>
          </div>
        </div>

        <!-- EDUCATION SECTION FOR SIGNATURES -->
        <div class="education-section">
          <div class="edu-header">
            <h2>üìö Understanding <span>Digital Signatures</span></h2>
            <p>Encryption hides what you said. Signatures prove who said it ‚Äî and that nobody changed a word.</p>
          </div>

          <div class="edu-grid">
            <!-- What is a Digital Signature? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">‚úçÔ∏è</div>
                <div>
                  <div class="edu-card-title">What is a Digital Signature?</div>
                  <div class="edu-card-subtitle">Better than a handwritten one in every measurable way</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>A handwritten signature is easy to forge, impossible to tie to a specific document, and proves nothing about whether the document was altered after signing. Digital signatures solve all three problems with mathematics.</p>
                <p>A digital signature is a piece of data, computed from a message and a private key, that provides three guarantees no physical signature ever could:</p>
                <p><strong>1. Authentication</strong> ‚Äî it could only have been created by someone who holds the private key<br>
                   <strong>2. Integrity</strong> ‚Äî if even one bit of the message changes, the signature becomes invalid<br>
                   <strong>3. Non-repudiation</strong> ‚Äî the signer cannot plausibly claim they didn't sign it (the math doesn't lie)</p>
                <div class="edu-highlight">
                  <strong>The asymmetry is elegant:</strong> creating a signature requires the private key (which only you have). Verifying a signature only requires the public key (which anyone can have). The world can verify, but only you can sign.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag year">1976</span>
                <span class="edu-tag">Diffie-Hellman paper</span>
                <span class="edu-tag">Fundamental primitive</span>
              </div>
            </div>

            <!-- How Signing Works -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üìù</div>
                <div>
                  <div class="edu-card-title">How Signing Works</div>
                  <div class="edu-card-subtitle">What happens when you click "Sign Message"</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>The process is surprisingly simple, even though the math underneath is not:</p>
                <div class="timeline">
                  <div class="timeline-item"><span class="timeline-year">Step 1</span><div class="timeline-text">Your message is converted to bytes using UTF-8 encoding</div></div>
                  <div class="timeline-item"><span class="timeline-year">Step 2</span><div class="timeline-text">ML-DSA-65 takes the message bytes and your 4,032-byte private key as input</div></div>
                  <div class="timeline-item"><span class="timeline-year">Step 3</span><div class="timeline-text">The algorithm produces a signature ‚Äî a unique piece of data (typically ~3,300 bytes) that's mathematically bound to both the message and your key</div></div>
                  <div class="timeline-item"><span class="timeline-year">Step 4</span><div class="timeline-text">You share the message, the signature, and your public key. The message is <em>not</em> encrypted ‚Äî signing is about proof, not secrecy</div></div>
                </div>
                <div class="edu-highlight">
                  <strong>Critical property:</strong> The signature is bound to both the message <em>and</em> your key simultaneously. Change a single character of the message, and the signature becomes invalid. Use a different key, and the signature becomes invalid. There's no way to "transplant" a signature from one message to another.
                </div>
              </div>
            </div>

            <!-- How Verification Works -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">‚úÖ</div>
                <div>
                  <div class="edu-card-title">How Verification Works</div>
                  <div class="edu-card-subtitle">Anyone can verify ‚Äî no secrets required</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>Verification is the beautiful counterpart to signing. Anyone in the world who has the signer's public key can verify a signature ‚Äî they never need the private key, and they never need to trust a third party.</p>
                <div class="timeline">
                  <div class="timeline-item"><span class="timeline-year">Input</span><div class="timeline-text">The message, the signature, and the signer's 1,952-byte public key</div></div>
                  <div class="timeline-item"><span class="timeline-year">Math</span><div class="timeline-text">ML-DSA-65 checks the mathematical relationship between all three inputs. This involves lattice operations over module structures ‚Äî hard to forge, fast to verify.</div></div>
                  <div class="timeline-item"><span class="timeline-year">Output</span><div class="timeline-text"><strong>Valid ‚úì</strong> ‚Äî the signature was made by this key on this exact message. Or <strong>Invalid ‚úó</strong> ‚Äî something doesn't match.</div></div>
                </div>
                <p>There is no "almost valid." No "close enough." Verification is a binary yes-or-no, and the probability of a forged signature passing is cryptographically negligible (less than 1 in 2<sup>128</sup>).</p>
              </div>
            </div>

            <!-- Signing vs Encryption -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üîÄ</div>
                <div>
                  <div class="edu-card-title">Signing vs. Encryption</div>
                  <div class="edu-card-subtitle">They look similar but solve opposite problems</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>People often confuse these because both use public/private key pairs. But they serve opposite purposes and use the keys in opposite directions:</p>
                <div class="edu-comparison">
                  <div class="edu-comp-col">
                    <h4 style="color:var(--accent-magenta)">Signing</h4>
                    <ul>
                      <li>Proves who sent it</li>
                      <li>Proves it wasn't modified</li>
                      <li>Message stays readable by everyone</li>
                      <li>Uses YOUR private key to create</li>
                      <li>Uses YOUR public key to verify</li>
                    </ul>
                  </div>
                  <div class="edu-comp-col">
                    <h4 style="color:var(--accent-cyan)">Encryption</h4>
                    <ul>
                      <li>Hides the message content</li>
                      <li>Only the recipient can read it</li>
                      <li>Doesn't prove who sent it</li>
                      <li>Uses THEIR public key to encrypt</li>
                      <li>Uses THEIR private key to decrypt</li>
                    </ul>
                  </div>
                </div>
                <div class="edu-highlight">
                  <strong>Best practice:</strong> For sensitive communications, do BOTH ‚Äî encrypt for confidentiality, then sign for authenticity. This is exactly what protocols like S/MIME, PGP, and secure messaging apps do under the hood.
                </div>
              </div>
            </div>

            <!-- Real World Uses -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">üåç</div>
                <div>
                  <div class="edu-card-title">Signatures Are Everywhere</div>
                  <div class="edu-card-subtitle">You relied on them hundreds of times today</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p><strong>Every website you visited today</strong> ‚Äî your browser verified a signature chain (HTTPS certificates) to confirm the site is real, not an impersonator. That padlock icon is a passed signature check.</p>
                <p><strong>Every app update you installed</strong> ‚Äî iOS, Android, Windows, and macOS all verify digital signatures on updates before installing them. Without this, malware could masquerade as a system update.</p>
                <p><strong>Every cryptocurrency transaction</strong> ‚Äî Bitcoin, Ethereum, and every blockchain use signatures to prove that the person spending coins actually owns them. No signature, no transaction.</p>
                <p><strong>Every commit in this project's git history</strong> ‚Äî git supports signing commits to prove the code change came from who it claims to be from, preventing supply-chain attacks.</p>
                <div class="edu-highlight">
                  <strong>Signatures are the internet's trust layer.</strong> Without them, you couldn't distinguish a real bank website from a fake one, a legitimate software update from malware, or a valid transaction from a forged one.
                </div>
              </div>
              <div class="edu-meta">
                <span class="edu-tag pro">Billions of verifications per day</span>
                <span class="edu-tag">Trust infrastructure</span>
              </div>
            </div>

            <!-- Why Post-Quantum Signatures? -->
            <div class="edu-card">
              <div class="edu-card-header">
                <div class="edu-card-icon">‚ö†Ô∏è</div>
                <div>
                  <div class="edu-card-title">Why Post-Quantum Signatures Matter</div>
                  <div class="edu-card-subtitle">The threat is different ‚Äî and in some ways worse ‚Äî than for encryption</div>
                </div>
              </div>
              <div class="edu-card-body">
                <p>Encryption has a "harvest now, decrypt later" problem. Signatures have something arguably worse: <strong>retroactive forgery</strong>.</p>
                <p>Current signature algorithms (RSA, ECDSA, EdDSA) will be broken by quantum computers. Once broken, an attacker doesn't just read old messages ‚Äî they can <em>create new signatures that look like they were made in the past</em>. They could forge a contract you never signed. Backdate a fraudulent transaction. Impersonate your code-signing identity on software released years ago.</p>
                <div class="edu-highlight">
                  <strong>For anything with long-term legal or security value</strong> ‚Äî property records, corporate contracts, code-signing certificates, patent filings, medical records ‚Äî the signatures need to survive the arrival of quantum computers. That means using post-quantum algorithms <em>now</em>, not later.
                </div>
                <p>ML-DSA-65 (used in this tool) is NIST's answer: a signature algorithm built on lattice math that remains secure against both classical and quantum attacks, based on current mathematical understanding.</p>
              </div>
              <div class="edu-meta">
                <span class="edu-tag con">Retroactive forgery threat</span>
                <span class="edu-tag pro">ML-DSA is the countermeasure</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <div class="toast" id="toast"></div>

  <script type="module" src="main.js"></script>
</body>
</html>
